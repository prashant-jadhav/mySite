!function(t){function e(e){var i=e||window.event,n=[].slice.call(arguments,1),s=0,o=0,r=0;return e=t.event.fix(i),e.type="mousewheel",i.wheelDelta&&(s=i.wheelDelta/120),i.detail&&(s=-i.detail/3),r=s,void 0!==i.axis&&i.axis===i.HORIZONTAL_AXIS&&(r=0,o=-1*s),void 0!==i.wheelDeltaY&&(r=i.wheelDeltaY/120),void 0!==i.wheelDeltaX&&(o=-1*i.wheelDeltaX/120),n.unshift(e,s,o,r),(t.event.dispatch||t.event.handle).apply(this,n)}var i=["DOMMouseScroll","mousewheel"];if(t.event.fixHooks)for(var n=i.length;n;)t.event.fixHooks[i[--n]]=t.event.mouseHooks;t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=i.length;t;)this.addEventListener(i[--t],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var t=i.length;t;)this.removeEventListener(i[--t],e,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}(jQuery),function(t,e,i){t.fn.jScrollPane=function(e){function n(e,n){function s(n){var r,c,d,u,p,v,m=!1,g=!1;if(I=n,R===i)p=e.scrollTop(),v=e.scrollLeft(),e.css({overflow:"hidden",padding:0}),L=e.innerWidth()+jt,q=e.innerHeight(),e.width(L),R=t('<div class="jspPane" />').css("padding",bt).append(e.children()),O=t('<div class="jspContainer" />').css({width:L+"px",height:q+"px"}).append(R).appendTo(e);else{if(e.css("width",""),m=I.stickToBottom&&$(),g=I.stickToRight&&B(),u=e.innerWidth()+jt!=L||e.outerHeight()!=q,u&&(L=e.innerWidth()+jt,q=e.innerHeight(),O.css({width:L+"px",height:q+"px"})),!u&&wt==N&&R.outerHeight()==G)return void e.width(L);wt=N,R.css("width",""),e.width(L),O.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}R.css("overflow","auto"),N=n.contentWidth?n.contentWidth:R[0].scrollWidth,G=R[0].scrollHeight,R.css("overflow",""),Q=N/L,V=G/q,K=V>1,U=Q>1,U||K?(e.addClass("jspScrollable"),r=I.maintainPosition&&(tt||nt),r&&(c=C(),d=S()),o(),a(),l(),r&&(x(g?N-L:c,!1),y(m?G-q:d,!1)),E(),D(),F(),I.enableKeyboardNavigation&&_(),I.clickOnTrack&&h(),P(),I.hijackInternalLinks&&Y()):(e.removeClass("jspScrollable"),R.css({top:0,width:O.width()-jt}),H(),W(),M(),f(),z()),I.autoReinitialise&&!gt?gt=setInterval(function(){s(I)},I.autoReinitialiseDelay):!I.autoReinitialise&&gt&&clearInterval(gt),p&&e.scrollTop(0)&&y(p,!1),v&&e.scrollLeft(0)&&x(v,!1),e.trigger("jsp-initialised",[U||K])}function o(){K&&(O.append(t('<div class="jspVerticalBar" />').append(t('<div class="jspCap jspCapTop" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragTop" />'),t('<div class="jspDragBottom" />'))),t('<div class="jspCap jspCapBottom" />'))),st=O.find(">.jspVerticalBar"),ot=st.find(">.jspTrack"),Z=ot.find(">.jspDrag"),I.showArrows&&(lt=t('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",u(0,-1)).bind("click.jsp",A),dt=t('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",u(0,1)).bind("click.jsp",A),I.arrowScrollOnHover&&(lt.bind("mouseover.jsp",u(0,-1,lt)),dt.bind("mouseover.jsp",u(0,1,dt))),d(ot,I.verticalArrowPositions,lt,dt)),at=q,O.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){at-=t(this).outerHeight()}),Z.hover(function(){Z.addClass("jspHover")},function(){Z.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",A),Z.addClass("jspActive");var i=e.pageY-Z.position().top;return t("html").bind("mousemove.jsp",function(t){m(t.pageY-i,!1)}).bind("mouseup.jsp mouseleave.jsp",v),!1}),r())}function r(){ot.height(at+"px"),tt=0,rt=I.verticalGutter+ot.outerWidth(),R.width(L-rt-jt);try{0===st.position().left&&R.css("margin-left",rt+"px")}catch(t){}}function a(){U&&(O.append(t('<div class="jspHorizontalBar" />').append(t('<div class="jspCap jspCapLeft" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragLeft" />'),t('<div class="jspDragRight" />'))),t('<div class="jspCap jspCapRight" />'))),ut=O.find(">.jspHorizontalBar"),pt=ut.find(">.jspTrack"),et=pt.find(">.jspDrag"),I.showArrows&&(vt=t('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",u(-1,0)).bind("click.jsp",A),mt=t('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",u(1,0)).bind("click.jsp",A),I.arrowScrollOnHover&&(vt.bind("mouseover.jsp",u(-1,0,vt)),mt.bind("mouseover.jsp",u(1,0,mt))),d(pt,I.horizontalArrowPositions,vt,mt)),et.hover(function(){et.addClass("jspHover")},function(){et.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",A),et.addClass("jspActive");var i=e.pageX-et.position().left;return t("html").bind("mousemove.jsp",function(t){b(t.pageX-i,!1)}).bind("mouseup.jsp mouseleave.jsp",v),!1}),ht=O.innerWidth(),c())}function c(){O.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){ht-=t(this).outerWidth()}),pt.width(ht+"px"),nt=0}function l(){if(U&&K){var e=pt.outerHeight(),i=ot.outerWidth();at-=e,t(ut).find(">.jspCap:visible,>.jspArrow").each(function(){ht+=t(this).outerWidth()}),ht-=i,q-=i,L-=e,pt.parent().append(t('<div class="jspCorner" />').css("width",e+"px")),r(),c()}U&&R.width(O.outerWidth()-jt+"px"),G=R.outerHeight(),V=G/q,U&&(ft=Math.ceil(1/Q*ht),ft>I.horizontalDragMaxWidth?ft=I.horizontalDragMaxWidth:ft<I.horizontalDragMinWidth&&(ft=I.horizontalDragMinWidth),et.width(ft+"px"),it=ht-ft,j(nt)),K&&(ct=Math.ceil(1/V*at),ct>I.verticalDragMaxHeight?ct=I.verticalDragMaxHeight:ct<I.verticalDragMinHeight&&(ct=I.verticalDragMinHeight),Z.height(ct+"px"),J=at-ct,g(tt))}function d(t,e,i,n){var s,o="before",r="after";"os"==e&&(e=/Mac/.test(navigator.platform)?"after":"split"),e==o?r=e:e==r&&(o=e,s=i,i=n,n=s),t[o](i)[r](n)}function u(t,e,i){return function(){return p(t,e,this,i),this.blur(),!1}}function p(e,i,n,s){n=t(n).addClass("jspActive");var o,r,a=!0,c=function(){0!==e&&kt.scrollByX(e*I.arrowButtonSpeed),0!==i&&kt.scrollByY(i*I.arrowButtonSpeed),r=setTimeout(c,a?I.initialDelay:I.arrowRepeatFreq),a=!1};c(),o=s?"mouseout.jsp":"mouseup.jsp",s=s||t("html"),s.bind(o,function(){n.removeClass("jspActive"),r&&clearTimeout(r),r=null,s.unbind(o)})}function h(){f(),K&&ot.bind("mousedown.jsp",function(e){if(e.originalTarget===i||e.originalTarget==e.currentTarget){var n,s=t(this),o=s.offset(),r=e.pageY-o.top-tt,a=!0,c=function(){var t=s.offset(),i=e.pageY-t.top-ct/2,o=q*I.scrollPagePercent,d=J*o/(G-q);if(0>r)tt-d>i?kt.scrollByY(-o):m(i);else{if(!(r>0))return void l();i>tt+d?kt.scrollByY(o):m(i)}n=setTimeout(c,a?I.initialDelay:I.trackClickRepeatFreq),a=!1},l=function(){n&&clearTimeout(n),n=null,t(document).unbind("mouseup.jsp",l)};return c(),t(document).bind("mouseup.jsp",l),!1}}),U&&pt.bind("mousedown.jsp",function(e){if(e.originalTarget===i||e.originalTarget==e.currentTarget){var n,s=t(this),o=s.offset(),r=e.pageX-o.left-nt,a=!0,c=function(){var t=s.offset(),i=e.pageX-t.left-ft/2,o=L*I.scrollPagePercent,d=it*o/(N-L);if(0>r)nt-d>i?kt.scrollByX(-o):b(i);else{if(!(r>0))return void l();i>nt+d?kt.scrollByX(o):b(i)}n=setTimeout(c,a?I.initialDelay:I.trackClickRepeatFreq),a=!1},l=function(){n&&clearTimeout(n),n=null,t(document).unbind("mouseup.jsp",l)};return c(),t(document).bind("mouseup.jsp",l),!1}})}function f(){pt&&pt.unbind("mousedown.jsp"),ot&&ot.unbind("mousedown.jsp")}function v(){t("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),Z&&Z.removeClass("jspActive"),et&&et.removeClass("jspActive")}function m(t,e){K&&(0>t?t=0:t>J&&(t=J),e===i&&(e=I.animateScroll),e?kt.animate(Z,"top",t,g):(Z.css("top",t),g(t)))}function g(t){t===i&&(t=Z.position().top),O.scrollTop(0),tt=t;var n=0===tt,s=tt==J,o=t/J,r=-o*(G-q);(yt!=n||Tt!=s)&&(yt=n,Tt=s,e.trigger("jsp-arrow-change",[yt,Tt,xt,Ct])),w(n,s),R.css("top",r),e.trigger("jsp-scroll-y",[-r,n,s]).trigger("scroll")}function b(t,e){U&&(0>t?t=0:t>it&&(t=it),e===i&&(e=I.animateScroll),e?kt.animate(et,"left",t,j):(et.css("left",t),j(t)))}function j(t){t===i&&(t=et.position().left),O.scrollTop(0),nt=t;var n=0===nt,s=nt==it,o=t/it,r=-o*(N-L);(xt!=n||Ct!=s)&&(xt=n,Ct=s,e.trigger("jsp-arrow-change",[yt,Tt,xt,Ct])),k(n,s),R.css("left",r),e.trigger("jsp-scroll-x",[-r,n,s]).trigger("scroll")}function w(t,e){I.showArrows&&(lt[t?"addClass":"removeClass"]("jspDisabled"),dt[e?"addClass":"removeClass"]("jspDisabled"))}function k(t,e){I.showArrows&&(vt[t?"addClass":"removeClass"]("jspDisabled"),mt[e?"addClass":"removeClass"]("jspDisabled"))}function y(t,e){var i=t/(G-q);m(i*J,e)}function x(t,e){var i=t/(N-L);b(i*it,e)}function T(e,i,n){var s,o,r,a,c,l,d,u,p,h=0,f=0;try{s=t(e)}catch(v){return}for(o=s.outerHeight(),r=s.outerWidth(),O.scrollTop(0),O.scrollLeft(0);!s.is(".jspPane");)if(h+=s.position().top,f+=s.position().left,s=s.offsetParent(),/^body|html$/i.test(s[0].nodeName))return;a=S(),l=a+q,a>h||i?u=h-I.verticalGutter:h+o>l&&(u=h-q+o+I.verticalGutter),u&&y(u,n),c=C(),d=c+L,c>f||i?p=f-I.horizontalGutter:f+r>d&&(p=f-L+r+I.horizontalGutter),p&&x(p,n)}function C(){return-R.position().left}function S(){return-R.position().top}function $(){var t=G-q;return t>20&&t-S()<10}function B(){var t=N-L;return t>20&&t-C()<10}function D(){O.unbind($t).bind($t,function(t,e,i,n){var s=nt,o=tt;return kt.scrollBy(i*I.mouseWheelSpeed,-n*I.mouseWheelSpeed,!1),s==nt&&o==tt})}function H(){O.unbind($t)}function A(){return!1}function E(){R.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(t){T(t.target,!1)})}function W(){R.find(":input,a").unbind("focus.jsp")}function _(){function i(){var t=nt,e=tt;switch(n){case 40:kt.scrollByY(I.keyboardSpeed,!1);break;case 38:kt.scrollByY(-I.keyboardSpeed,!1);break;case 34:case 32:kt.scrollByY(q*I.scrollPagePercent,!1);break;case 33:kt.scrollByY(-q*I.scrollPagePercent,!1);break;case 39:kt.scrollByX(I.keyboardSpeed,!1);break;case 37:kt.scrollByX(-I.keyboardSpeed,!1)}return s=t!=nt||e!=tt}var n,s,o=[];U&&o.push(ut[0]),K&&o.push(st[0]),R.focus(function(){e.focus()}),e.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(e){if(e.target===this||o.length&&t(e.target).closest(o).length){var r=nt,a=tt;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:n=e.keyCode,i();break;case 35:y(G-q),n=null;break;case 36:y(0),n=null}return s=e.keyCode==n&&r!=nt||a!=tt,!s}}).bind("keypress.jsp",function(t){return t.keyCode==n&&i(),!s}),I.hideFocus?(e.css("outline","none"),"hideFocus"in O[0]&&e.attr("hideFocus",!0)):(e.css("outline",""),"hideFocus"in O[0]&&e.attr("hideFocus",!1))}function M(){e.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function P(){if(location.hash&&location.hash.length>1){var e,i,n=escape(location.hash);try{e=t(n)}catch(s){return}e.length&&R.find(n)&&(0===O.scrollTop()?i=setInterval(function(){O.scrollTop()>0&&(T(n,!0),t(document).scrollTop(O.position().top),clearInterval(i))},50):(T(n,!0),t(document).scrollTop(O.position().top)))}}function z(){t("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function Y(){z(),t("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var t,e=this.href.split("#");return e.length>1&&(t=e[1],t.length>0&&R.find("#"+t).length>0)?(T("#"+t,!0),!1):void 0})}function F(){var t,e,i,n,s,o=!1;O.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(r){var a=r.originalEvent.touches[0];t=C(),e=S(),i=a.pageX,n=a.pageY,s=!1,o=!0}).bind("touchmove.jsp",function(r){if(o){var a=r.originalEvent.touches[0],c=nt,l=tt;return kt.scrollTo(t+i-a.pageX,e+n-a.pageY),s=s||Math.abs(i-a.pageX)>5||Math.abs(n-a.pageY)>5,c==nt&&l==tt}}).bind("touchend.jsp",function(t){o=!1}).bind("click.jsp-touchclick",function(t){return s?(s=!1,!1):void 0})}function X(){var t=S(),i=C();e.removeClass("jspScrollable").unbind(".jsp"),e.replaceWith(St.append(R.children())),St.scrollTop(t),St.scrollLeft(i)}var I,R,L,q,O,N,G,Q,V,K,U,Z,J,tt,et,it,nt,st,ot,rt,at,ct,lt,dt,ut,pt,ht,ft,vt,mt,gt,bt,jt,wt,kt=this,yt=!0,xt=!0,Tt=!1,Ct=!1,St=e.clone(!1,!1).empty(),$t=t.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";bt=e.css("paddingTop")+" "+e.css("paddingRight")+" "+e.css("paddingBottom")+" "+e.css("paddingLeft"),jt=(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0),t.extend(kt,{reinitialise:function(e){e=t.extend({},I,e),s(e)},scrollToElement:function(t,e,i){T(t,e,i)},scrollTo:function(t,e,i){x(t,i),y(e,i)},scrollToX:function(t,e){x(t,e)},scrollToY:function(t,e){y(t,e)},scrollToPercentX:function(t,e){x(t*(N-L),e)},scrollToPercentY:function(t,e){y(t*(G-q),e)},scrollBy:function(t,e,i){kt.scrollByX(t,i),kt.scrollByY(e,i)},scrollByX:function(t,e){var i=C()+Math[0>t?"floor":"ceil"](t),n=i/(N-L);b(n*it,e)},scrollByY:function(t,e){var i=S()+Math[0>t?"floor":"ceil"](t),n=i/(G-q);m(n*J,e)},positionDragX:function(t,e){b(t,e)},positionDragY:function(t,e){m(t,e)},animate:function(t,e,i,n){var s={};s[e]=i,t.animate(s,{duration:I.animateDuration,easing:I.animateEase,queue:!1,step:n})},getContentPositionX:function(){return C()},getContentPositionY:function(){return S()},getContentWidth:function(){return N},getContentHeight:function(){return G},getPercentScrolledX:function(){return C()/(N-L)},getPercentScrolledY:function(){return S()/(G-q)},getIsScrollableH:function(){return U},getIsScrollableV:function(){return K},getContentPane:function(){return R},scrollToBottom:function(t){m(J,t)},hijackInternalLinks:function(){Y()},destroy:function(){X()}}),s(n)}return e=t.extend({},t.fn.jScrollPane.defaults,e),t.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){e[this]=e[this]||e.speed}),this.each(function(){var i=t(this),s=i.data("jsp");s?s.reinitialise(e):(s=new n(i,e),i.data("jsp",s))})},t.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:i,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery,this),function(){var t=jQuery.event,e=function(t,e,i,n){var s,o,r,a,c,l,d,u,p;for(s=0;s<e.length;s++)for(o=e[s],a=o.indexOf(".")<0,a||(d=o.split("."),o=d.shift(),u=new RegExp("(^|\\.)"+d.slice(0).sort().join("\\.(?:.*\\.)?")+"(\\.|$)")),r=(t[o]||[]).slice(0),c=0;c<r.length;c++)l=r[c],p=a||u.test(l.namespace),p&&(n?l.selector===n&&i(o,l.origHandler||l.handler):null===n?i(o,l.origHandler||l.handler,l.selector):l.selector||i(o,l.origHandler||l.handler))};t.find=function(t,i,n){var s=($._data(t)||{}).events,o=[];return s?(e(s,i,function(t,e){o.push(e)},n),o):o},t.findBySelector=function(t,i){var n=$._data(t).events,s={},o=function(t,e,i){var n=s[t]||(s[t]={}),o=n[e]||(n[e]=[]);o.push(i)};return n?(e(n,i,function(t,e,i){o(i||"",t,e)},null),s):s},t.supportTouch="ontouchend"in document,$.fn.respondsTo=function(e){return this.length?t.find(this[0],$.isArray(e)?e:[e]).length>0:!1},$.fn.triggerHandled=function(t,e){return t="string"==typeof t?$.Event(t):t,this.trigger(t,e),t.handled},t.setupHelper=function(e,i,n){n||(n=i,i=null);var s=function(s){var o,r=s.selector||"";r?(o=t.find(this,e,r),o.length||$(this).delegate(r,i,n)):t.find(this,e,r).length||t.add(this,i,n,{selector:r,delegate:this})},o=function(s){var o,r=s.selector||"";r?(o=t.find(this,e,r),o.length||$(this).undelegate(r,i,n)):t.find(this,e,r).length||t.remove(this,i,n,{selector:r,delegate:this})};$.each(e,function(){t.special[this]={add:s,remove:o,setup:function(){},teardown:function(){}}})}}(jQuery),function(t){var e=/Phantom/.test(navigator.userAgent),i=!e&&"ontouchend"in document,n=i?"touchstart":"mousedown",s=i?"touchend":"mouseup",o=i?"touchmove":"mousemove",r=function(e){var i=e.originalEvent.touches?e.originalEvent.touches[0]:e;return{time:(new Date).getTime(),coords:[i.pageX,i.pageY],origin:t(e.target)}},a=t.event.swipe={delay:500,max:75,min:30};t.event.setupHelper(["swipe","swipeleft","swiperight","swipeup","swipedown"],n,function(e){function i(t){c&&(n=r(t),Math.abs(c.coords[0]-n.coords[0])>10&&t.preventDefault())}var n,c=r(e),l=e.delegateTarget||e.currentTarget,d=e.handleObj.selector,u=this;t(document.documentElement).bind(o,i).one(s,function(s){if(t(this).unbind(o,i),c&&n){var r=Math.abs(c.coords[0]-n.coords[0]),p=Math.abs(c.coords[1]-n.coords[1]),h=Math.sqrt(r*r+p*p);if(n.time-c.time<a.delay&&h>=a.min){var f=["swipe"];r>=a.min&&p<a.min?f.push(c.coords[0]>n.coords[0]?"swipeleft":"swiperight"):p>=a.min&&r<a.min&&f.push(c.coords[1]<n.coords[1]?"swipedown":"swipeup"),t.each(t.event.find(l,f,d),function(){this.call(u,e,{start:c,end:n})})}}c=n=void 0})})}(jQuery),function(t,e,i){"use strict";var n,s,o=t.event;n=o.special.debouncedresize={setup:function(){t(this).on("resize",n.handler)},teardown:function(){t(this).off("resize",n.handler)},handler:function(t,e){var i=this,r=arguments,a=function(){t.type="debouncedresize",o.dispatch.apply(i,r)};s&&clearTimeout(s),e?a():s=setTimeout(a,n.threshold)},threshold:150};var r=t(e),a=e.Modernizr;t.BookBlock=function(e,i){this.$el=t(i),this._init(e)},t.BookBlock.defaults={speed:1e3,easing:"ease-in-out",shadows:!0,shadowSides:.2,shadowFlip:.1,perspective:1300,circular:!1,nextEl:"",prevEl:"",autoplay:!1,interval:3e3,keyboard:!0,onEndFlip:function(t,e,i){return!1},onBeforeFlip:function(t){return!1}},t.BookBlock.prototype={_init:function(e){this.options=t.extend(!0,{},t.BookBlock.defaults,e),this.$el.css("perspective",this.options.perspective),this.$items=this.$el.children(".bb-item"),this.itemsCount=this.$items.length,this.current=0,this.previous=-1,this.$current=this.$items.eq(this.current).show(),this.elWidth=this.$el.width();var i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.transEndEventName=i[a.prefixed("transition")]+".bookblock",this.support=a.csstransitions&&a.csstransforms3d,this._initEvents(),this.options.autoplay&&(this.options.circular=!0,this._startSlideshow())},_initEvents:function(){var e=this;""!==this.options.nextEl&&t(this.options.nextEl).on("click.bookblock",function(){return e._action("next"),!1}),""!==this.options.prevEl&&t(this.options.prevEl).on("click.bookblock",function(){return e._action("prev"),!1}),1==this.options.keyboard&&t(document).keydown(function(t){var i=t.keyCode||t.which,n={left:37,up:38,right:39,down:40};switch(i){case n.left:e._action("prev");break;case n.right:e._action("next")}}),r.on("debouncedresize",function(){e.elWidth=e.$el.width()})},_action:function(t,e){this._stopSlideshow(),this._navigate(t,e)},_navigate:function(t,e){return this.isAnimating?!1:(this.options.onBeforeFlip(this.current),this.isAnimating=!0,this.$current=this.$items.eq(this.current),e!==i?this.current=e:"next"===t?this.options.circular||this.current!==this.itemsCount-1?(this.previous=this.current,this.current=this.current<this.itemsCount-1?this.current+1:0):this.end=!0:"prev"===t&&(this.options.circular||0!==this.current?(this.previous=this.current,this.current=this.current>0?this.current-1:this.itemsCount-1):this.end=!0),this.$nextItem=!this.options.circular&&this.end?this.$current:this.$items.eq(this.current),void(this.support?this._layout(t):this._layoutNoSupport(t)))},_layoutNoSupport:function(t){this.$items.hide(),this.$nextItem.show(),this.end=!1,this.isAnimating=!1;var e="next"===t&&this.current===this.itemsCount-1||"prev"===t&&0===this.current;this.options.onEndFlip(this.previous,this.current,e)},_layout:function(t){var e=this,i=this._addSide("left",t),n=this._addSide("middle",t),s=this._addSide("right",t),o=i.find("div.bb-overlay"),r=n.find("div.bb-flipoverlay:first"),a=n.find("div.bb-flipoverlay:last"),c=s.find("div.bb-overlay"),l=this.end?400:this.options.speed;if(this.$items.hide(),this.$el.prepend(i,n,s),n.css({transition:"all "+l+"ms "+this.options.easing}).on(this.transEndEventName,function(i){if("bb-page"===i.target.className){e.$el.children("div.bb-page").remove(),e.$nextItem.show(),e.end=!1,e.isAnimating=!1;var n="next"===t&&e.current===e.itemsCount-1||"prev"===t&&0===e.current;e.options.onEndFlip(e.previous,e.current,n)}}),"prev"===t&&n.css({transform:"rotateY(-180deg)"}),this.options.shadows&&!this.end){var d="next"===t?{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms"}:{transition:"opacity "+this.options.speed/2+"ms linear",opacity:this.options.shadowSides},u="next"===t?{transition:"opacity "+this.options.speed/2+"ms linear"}:{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms",opacity:this.options.shadowFlip},p="next"===t?{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms",opacity:this.options.shadowFlip}:{transition:"opacity "+this.options.speed/2+"ms linear"},h="next"===t?{transition:"opacity "+this.options.speed/2+"ms linear",opacity:this.options.shadowSides}:{transition:"opacity "+this.options.speed/2+"ms linear "+this.options.speed/2+"ms"};r.css(u),a.css(p),o.css(d),c.css(h)}setTimeout(function(){var i="next"===t?"rotateY(-180deg)":"rotateY(0deg)";e.end&&(i="next"===t?"rotateY(-15deg)":"rotateY(-165deg)"),n.css({transform:i}),e.options.shadows&&!e.end&&(r.css({opacity:"next"===t?e.options.shadowFlip:0}),a.css({opacity:"next"===t?0:e.options.shadowFlip}),o.css({opacity:"next"===t?e.options.shadowSides:0}),c.css({opacity:"next"===t?0:e.options.shadowSides}))},30)},_addSide:function(e,i){var n;switch(e){case"left":n=t('<div class="bb-page"><div class="bb-back"><div class="bb-outer"><div class="bb-content" style="width:'+this.elWidth+'px"><div class="bb-inner">'+("next"===i?this.$current.html():this.$nextItem.html())+'</div></div><div class="bb-overlay"></div></div></div></div>').css("z-index",102);break;case"middle":n=t('<div class="bb-page"><div class="bb-front"><div class="bb-outer"><div class="bb-content" style="left:'+-this.elWidth/2+"px;width:"+this.elWidth+'px"><div class="bb-inner">'+("next"===i?this.$current.html():this.$nextItem.html())+'</div></div><div class="bb-flipoverlay"></div></div></div><div class="bb-back"><div class="bb-outer"><div class="bb-content" style="width:'+this.elWidth+'px"><div class="bb-inner">'+("next"===i?this.$nextItem.html():this.$current.html())+'</div></div><div class="bb-flipoverlay"></div></div></div></div>').css("z-index",103);break;case"right":n=t('<div class="bb-page"><div class="bb-front"><div class="bb-outer"><div class="bb-content" style="left:'+-this.elWidth/2+"px;width:"+this.elWidth+'px"><div class="bb-inner">'+("next"===i?this.$nextItem.html():this.$current.html())+'</div></div><div class="bb-overlay"></div></div></div></div>').css("z-index",101)}return n},_startSlideshow:function(){var t=this;this.slideshow=setTimeout(function(){t._navigate("next"),t.options.autoplay&&t._startSlideshow()},this.options.interval)},_stopSlideshow:function(){this.options.autoplay&&(clearTimeout(this.slideshow),this.options.autoplay=!1)},next:function(){this._action("next")},prev:function(){this._action("prev")},jump:function(t){return t-=1,t===this.current||t>=this.itemsCount||0>t?!1:void this._action(t>this.current?"next":"prev",t)},isActive:function(){return this.isAnimating},update:function(){var t=this.$items.eq(this.current);this.$items=this.$el.children(".bb-item"),this.itemsCount=this.$items.length,this.current=t.index()}};var c=function(t){e.console&&e.console.error(t)};t.fn.bookblock=function(e){var i=t.data(this,"bookblock");if("string"==typeof e){var n=Array.prototype.slice.call(arguments,1);this.each(function(){return i?t.isFunction(i[e])&&"_"!==e.charAt(0)?void i[e].apply(i,n):void c("no such method '"+e+"' for bookblock instance"):void c("cannot call methods on bookblock prior to initialization; attempted to call method '"+e+"'")})}else this.each(function(){i?i._init():i=t.data(this,"bookblock",new t.BookBlock(e,this))});return i}}(jQuery,window);var Page=function(){function t(){i("init"),e()}function e(){f.on("click",function(){return h.next(),!1}),v.on("click",function(){return h.prev(),!1}),d.on({swipeleft:function(t){return c.data("opened")?!1:(h.next(),!1)},swiperight:function(t){return c.data("opened")?!1:(h.prev(),!1)}}),g.on("click",o),m.on("click",function(){var t=$(this),e=t.index(),i=function(){h.jump(e+1)};return p!==e?a(i):a(),!1}),$(window).on("debouncedresize",function(){i("reinit")})}function i(t,e){var e=void 0===e?p:e,i=d.eq(e).children("div.content"),n=i.data("jsp");"init"===t&&void 0===n?i.jScrollPane({verticalGutter:0,hideFocus:!0}):"reinit"===t&&void 0!==n?n.reinitialise():"destroy"===t&&void 0!==n&&n.destroy()}function n(){m.removeClass("menu-toc-current").eq(p).addClass("menu-toc-current")}function s(t){0===p?(f.show(),v.hide()):t?(f.hide(),v.show()):(f.show(),v.show())}function o(){var t=c.data("opened");t?a():r()}function r(){f.hide(),v.hide(),c.addClass("slideRight").data("opened",!0)}function a(t){s(p===u-1),c.removeClass("slideRight").data("opened",!1),t&&(w?c.on(j,function(){$(this).off(j),t.call()}):t.call())}var c=$("#container"),l=$("#bb-bookblock"),d=l.children(),u=d.length,p=0,h=$("#bb-bookblock").bookblock({speed:800,perspective:2e3,shadowSides:.8,shadowFlip:.4,onEndFlip:function(t,e,o){p=e,n(),s(o),i("init"),i("destroy",t)}}),f=$("#bb-nav-next"),v=$("#bb-nav-prev").hide(),m=c.find("ul.menu-toc > li"),g=$("#tblcontents"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},j=b[Modernizr.prefixed("transition")],w=Modernizr.csstransitions;return{init:t}}();